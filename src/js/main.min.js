const htmlElement=document.documentElement,withThemeToggle=document.getElementById("withThemeToggle");console.log(withThemeToggle),withThemeToggle.addEventListener("click",(()=>{console.log(withThemeToggle),htmlElement.classList.toggle("with"),localStorage.setItem("theme",htmlElement.classList.contains("with")?"with":"light")}));const savedTheme=localStorage.getItem("theme");"with"===savedTheme&&htmlElement.classList.add("with");const limit=25;let page=1;const getContactsListQueryUrl="/api/v4/contacts",createTaskUrl="/api/v4/tasks";async function getContacts(){try{let e=await $.ajax({url:"/api/v4/contacts",method:"GET",data:{limit:25,with:"leads",page:page}});return e&&e._embedded&&e._embedded.contacts.length>0?e._embedded.contacts:(console.log("Контактов нет"),[])}catch(e){console.error("Ошибка при получении контактов:",e)}}async function createTask(e){const t={request:{task:{name:"Контакт без сделок",created_by:1,responsible_user_id:1,status:0,entity_type:"contacts",entity_id:e}}};try{await $.ajax({url:createTaskUrl,method:"POST",contentType:"application/json",data:JSON.stringify(t)}),console.log(`Задача для контакта ${e} успешно создана.`)}catch(e){console.error("Ошибка при создании задачи:",e)}}async function processContacts(){let e=await getContacts();for(let t of e)t._embedded.leads&&0!==t._embedded.leads.length||await createTask(t.id)}processContacts();